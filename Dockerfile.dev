# Dockerfile para ambiente de desenvolvimento
FROM node:18-alpine

# Instalar dependências globais para desenvolvimento
RUN npm install -g concurrently nodemon

WORKDIR /app

# Copiar package.json files
COPY package.json package-lock.json* ./
COPY apps/api/package.json ./apps/api/
COPY apps/client/package.json ./apps/client/

# Instalar todas as dependências (dev + prod)
RUN npm install

# Copiar código fonte
COPY apps ./apps

# Expor portas para API e Cliente
EXPOSE 8080 5173

# Definir variáveis de ambiente de desenvolvimento
ENV NODE_ENV=development

# Comando para desenvolvimento (ambos os serviços)
CMD ["npm", "run", "dev"]